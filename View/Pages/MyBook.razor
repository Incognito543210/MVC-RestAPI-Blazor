@page "/mybook"
@inject NavigationManager NavMan
@inject RecipeService RecServ

<div id="top">
    <div id="title">
        <h3 style="font-weight: bold">Moje przepisy</h3>
    </div>
    <div id="buttons">
        <MudButton class="btn1" @onclick="onClick">Nowy przepis</MudButton>
    </div>
</div>

<div style="clear: both;"></div>

@if (recipesList == null)
{
    <h3>Loading...</h3>
}
else
{
    @if (recipesList.Any())
    {
        <div id="recipes">
             @foreach (var recipe in recipesList)
            {
                <div id="recipe" @onclick="() => navigateToRecipe(recipe.RecipeID)">
                    <img src="https://wszystkiegoslodkiego.pl/storage/images/201922/letni-tort-bezowy.webp">
                    <div id="description">
                        <h5 style="font-weight: bold">@recipe.Title</h5>
                        <p>
                            <b>Data dodania: </b>@recipe.PrepareTime<br />
                            <b>Porcje: </b>@recipe.Portions<br />
                            <b>Trudność: </b>@recipe.Difficulty/5<br />
                        </p>
                    </div>

                </div>
            }
        </div>
    }
}

<style>
    #top {
        width: auto;
        margin: 10px;
        padding: 5px;
        align-content: center;
        display: flex;
        justify-content: space-between;
    }

    #title {
        flex: 1;
    }

    h3 {
        margin: 0;
        padding: 0;
    }

    #recipe {
        display: flex;
        flex-direction: row;
    }

    #buttons {
        display: flex;
        justify-content: flex-end;
    }

    .btn1 {
        background: rgba( 22, 166, 185 );
        padding: 10px;
        float: right;
        border-radius: 8px;
        font-size: 1.17em;
        color: white;
    }
        .btn1:hover {
            background-color: rgba(227, 225, 222);
        }

    #recipe:hover {
        background: rgba( 22, 166, 185 );
        cursor: pointer;
        border-radius: 8px;
    }

    img {
        margin-bottom: 20px;
        margin-top: 20px;
        margin-left: 20px;
        margin-right: 20px;
        border-radius: 8px;
        height: 100px;
        float: left;
    }

    #description {
        margin-bottom: 20px;
        margin-top: 20px;
        margin-left: 20px;
        margin-right: 20px;
        height: 100px;
        float: left;
    }
</style>


@code {
    private List<RecipeDto>? recipesList;


    protected override async Task OnInitializedAsync()
    {
        await base.OnInitializedAsync();
        recipesList = await RecServ.GetRecipeListAsync();
    }

    List<RecipeDto> recipes = new();

    void navigateToRecipe(int id)
    {
        NavMan.NavigateTo("/myrecipe/" + id);
    }

    void onClick() => NavMan.NavigateTo("/newrecipe");
}
